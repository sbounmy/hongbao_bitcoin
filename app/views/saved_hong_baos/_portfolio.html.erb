<% if saved_hong_baos.any? %>
  <!-- User Header -->
  <div class="flex items-center justify-between gap-3 mb-6">
    <div class="flex items-center gap-3">
      <div class="w-8 h-8 rounded-full overflow-hidden">
        <%= render AvatarComponent.new(user: saved_hong_baos.first.user, class: "w-full h-full object-cover") %>
      </div>
      <div>
        <div class="flex items-center gap-2">
          <span class="font-semibold text-base-content"><%= saved_hong_baos.first.user.email.split("@").first.capitalize %></span>
          <%= heroicon "chevron-right", variant: :solid, class: "w-4 h-4 text-base-content/40" %>
          <span class="text-base-content/60">HongBao gifted</span>
        </div>
      </div>
    </div>

    <!-- Bitcoin Price Display -->
    <%= render Spots::CurrentComponent.new(vs: 1.day.ago) %>
  </div>

<!-- Bitcoin Portfolio Chart -->
<div class="card bg-base-100 shadow-xl border-2 border-base-content/10 mb-8">
  <div class="card-body">
    <%= render SavedHongBaos::StatsComponent.new(saved_hong_baos:) %>

    <%= render Charts::PortfolioChartComponent.new(saved_hong_baos:, height: "450px") %>
  </div>
</div>
<% end %>

<% readonly ||= false %>

<!-- Saved Hong Baos Table/List -->
<div class="card shadow-xl border-2 border-base-content/10 hidden md:block">
  <div class='card-body p-0'>
    <div class="overflow-x-auto max-h-96 overflow-y-auto">
      <table class="table table-zebra w-full">
        <thead class="sticky top-0 bg-base-100 z-10">
          <tr>
            <th>Date</th>
            <th>Status</th>
            <th>Recipient</th>
            <th>Address</th>
            <th>Amount</th>
            <th>Balance</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="saved_hong_baos_table">
          <%= render SavedHongBaos::ItemComponent.with_collection(saved_hong_baos, view_type: :table, readonly:) %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Mobile view - Cards with scrollable container -->
<div class="card shadow-xl border-2 border-base-content/10 md:hidden mt-4">
  <div class="card-body p-0">
    <div class="px-4 py-3 border-b border-base-content/10">
      <h3 class="font-semibold text-base-content">HongBao Gifted</h3>
      <p class="text-xs text-base-content/60 mt-1">Swipe up to see all wallets</p>
    </div>
    <div id="saved_hong_baos_cards" class="max-h-[50vh] overflow-y-auto p-2 space-y-2">
      <%= render SavedHongBaos::ItemComponent.with_collection(saved_hong_baos, view_type: :card, readonly:) %>
    </div>
  </div>
</div>
