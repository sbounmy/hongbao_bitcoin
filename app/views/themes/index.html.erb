<%# Horizontal scroll container %>
<div data-controller="theme-select"
     data-theme-select-original-id-value="<%= @current_id %>"
     class="overflow-x-auto">
  <div class="flex gap-4 px-4 pb-2">
    <% @themes.each do |theme| %>
      <% next unless theme.image_front.attached? && theme.image_back.attached? %>
      <label class="cursor-pointer group flex-shrink-0 w-20">
        <%# Hidden radio %>
        <input type="radio"
               name="theme"
               value="<%= theme.id %>"
               class="peer sr-only"
               <%= "checked" if theme.id == @current_id %>
               data-theme-select-target="radio"
               data-action="change->theme-select#preview"
               data-theme-slug="<%= theme.slug %>"
               data-theme-front-url="<%= url_for(theme.image_front) %>"
               data-theme-back-url="<%= url_for(theme.image_back) %>"
               data-theme-elements="<%= theme.ai.to_json %>">

        <%# Thumbnail %>
        <div class="aspect-square rounded-lg overflow-hidden bg-base-200 border-2 border-transparent
                    peer-checked:border-primary peer-checked:ring-2 peer-checked:ring-primary
                    group-hover:border-primary/50 transition-all">
          <% if theme.image_hero.attached? %>
            <%= image_tag theme.image_hero.variant(resize_to_fill: [80, 80]),
                class: "w-full h-full object-cover", loading: "lazy" %>
          <% else %>
            <div class="flex items-center justify-center h-full text-base-content/50">
              <%= heroicon "photo", class: "w-6 h-6" %>
            </div>
          <% end %>
        </div>

        <%# Theme name below thumbnail %>
        <p class="text-xs text-center mt-1 truncate text-base-content/70
                  peer-checked:text-primary peer-checked:font-semibold transition-colors">
          <%= theme.name %>
        </p>
      </label>
    <% end %>
  </div>
</div>
