<%= turbo_frame_tag "qr_scanner" %>

<div class="min-h-screen bg-[#FFE5E5] flex flex-col gap-10 items-center justify-center p-4">
  <div class="w-full max-w-xl bg-[#F04747] p-8
              border-4 border-[#FFB636] outline outline-8 outline-[#F04747]
              rounded-2xl shadow-2xl relative">

    <%= render "hong_baos/new/header" %>
    <%= form_with(model: @hong_bao,
                  url: new_hong_bao_path,
                  class: "space-y-6",
                  data: {
                    controller: "hong-bao",
                    hong_bao_current_step_value: @current_step,
                    hong_bao_current_paper_value: @hong_bao.paper_id,
                    hong_bao_wallet_value: {
                      address: "",
                      privateKey: "",
                      mnemonic: "",
                      addressQrcode: "",
                      privateKeyQrcode: "",
                      publicKeyQrcode: ""
                    }.to_json
                  }) do |form| %>

      <%= render "hong_baos/new/progress_steps", current_step: @current_step %>
      <%= render "shared/error_messages", resource: @hong_bao if @hong_bao.errors.any? %>

      <%= render "hong_baos/new/steps/design",
          form: form,
          papers: @papers,
          hong_bao: @hong_bao %>

      <%= render "hong_baos/new/steps/print",
          form: form,
          hong_bao: @hong_bao,
          papers: @papers,
          selected_paper: @papers.find { |p| p.id.to_s == @hong_bao.paper_id.to_s } || @papers.first %>

      <%= render "hong_baos/new/steps/top_up",
          form: form,
          payment_methods: @payment_methods,
          hong_bao: @hong_bao %>

    <% end %>
  </div>

  <%= render "shared/faq" %>
  <%= render "shared/about" %>
  <%= render "shared/donate" %>
  <%= render "shared/footer" %>
</div>