<%# Suppress dock bar on this page %>
<% content_for(:footer) do %>
  <!-- No dock bar on paper new -->
<% end %>

<%# Instagram-style header in screen_header slot %>
<% content_for(:screen_header) do %>
  <%= render "papers/new/header" %>
<% end %>

<% attributes_for(:screen_attributes, {data: {controller: 'steps', steps_current_value: '1', steps_hidden_class: 'hidden'}}) %>

<%# Instagram-style single-page wizard %>
<div class="flex flex-col min-h-[calc(100vh-280px)] bg-base-100 rounded-xl overflow-hidden"
     data-controller="preview photo-select">

  <%= form_with(model: @paper, id: "paper-form", class: "flex-1 flex flex-col", local: false) do |form| %>
    <%# Step 1: Photo Picker with Recents/My Papers tabs %>
    <div data-steps-target="content"
         data-steps-index="1"
         class="flex-1 flex flex-col">
      <%= render "papers/new/steps/photo", form: form, papers: @papers, recent_photos: @recent_photos, pagy: @pagy %>
    </div>

    <%# Step 2: Style Selection %>
    <div data-steps-target="content"
         data-steps-index="2"
         class="hidden flex-1 flex flex-col">
      <%= render "papers/new/steps/style", form: form, styles: @styles %>
    </div>

    <%# Hidden theme field (theme selection comes later in flow) %>
    <%= form.fields_for :input_item_theme_attributes do |theme_form| %>
      <%= theme_form.hidden_field :input_id, value: @themes.first.id %>
    <% end %>
  <% end %>
</div>
