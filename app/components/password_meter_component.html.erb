<div class="<%= container_classes %> space-y-2"
     data-controller="password-meter <%= show_visibility_toggle ? 'password-visibility' : '' %>"
     <%= stimulus_values.map { |k, v| "#{k}=\"#{v}\"" }.join(' ').html_safe %>
     <%= stimulus_classes.map { |k, v| "#{k}=\"#{v}\"" }.join(' ').html_safe %>>

  <!-- Password Input Field -->
  <div class="relative">
    <input type="password"
           id="<%= input_id %>"
           name="<%= name %>"
           placeholder="<%= placeholder %>"
           data-password-meter-target="input"
           data-action="input->password-meter#evaluate"
           <% if show_visibility_toggle %>
           data-password-visibility-target="input"
           <% end %>
           <% data_targets.each do |controller, target| %>
           data-<%= controller %>-target="<%= target %>"
           <% end %>
           class="<%= input_classes %>">

    <% if show_visibility_toggle %>
    <button type="button"
            data-action="password-visibility#toggle"
            class="absolute right-2 top-1/2 -translate-y-1/2 text-white/70 hover:text-white">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
      </svg>
    </button>
    <% end %>
  </div>

  <% if show_meter %>
    <div class="<%= meter_container_classes %>">
      <div class="flex items-center justify-between">
        <span class="text-xs font-medium text-white/70">Password Strength:</span>
        <span data-password-meter-target="meterText"
              class="badge badge-sm text-xs font-semibold">
          Too Short
        </span>
      </div>

      <div class="w-full bg-white/20 rounded-full h-2 overflow-hidden"
           data-password-meter-target="meter"
           role="progressbar"
           aria-label="Password strength"
           aria-valuemin="0"
           aria-valuemax="100">
        <div data-password-meter-target="meterFill"
             class="h-full transition-all duration-300 ease-out rounded-full bg-red-500"
             style="width: 0%">
        </div>
      </div>
    </div>
  <% end %>

  <% if show_requirements && !compact %>
    <div class="<%= requirements_container_classes %>">
      <div class="<%= requirement_classes %>"
           data-password-meter-target="lengthRequirement"
           data-password-meter-requirement>
        <span data-password-meter-icon class="w-4 text-center">✗</span>
        <span>At least <%= min_length %> characters</span>
      </div>

      <% if require_uppercase %>
        <div class="<%= requirement_classes %>"
             data-password-meter-target="uppercaseRequirement"
             data-password-meter-requirement>
          <span data-password-meter-icon class="w-4 text-center">✗</span>
          <span>Uppercase letters (A-Z)</span>
        </div>
      <% end %>

      <% if require_lowercase %>
        <div class="<%= requirement_classes %>"
             data-password-meter-target="lowercaseRequirement"
             data-password-meter-requirement>
          <span data-password-meter-icon class="w-4 text-center">✗</span>
          <span>Lowercase letters (a-z)</span>
        </div>
      <% end %>

      <% if require_numbers %>
        <div class="<%= requirement_classes %>"
             data-password-meter-target="numberRequirement"
             data-password-meter-requirement>
          <span data-password-meter-icon class="w-4 text-center">✗</span>
          <span>Numbers (0-9)</span>
        </div>
      <% end %>

      <% if require_special %>
        <div class="<%= requirement_classes %>"
             data-password-meter-target="specialRequirement"
             data-password-meter-requirement>
          <span data-password-meter-icon class="w-4 text-center">✗</span>
          <span>Special characters (<%= special_chars.chars.take(8).join %><% if special_chars.length > 8 %>...<% end %>)</span>
        </div>
      <% end %>
    </div>
  <% end %>
</div>